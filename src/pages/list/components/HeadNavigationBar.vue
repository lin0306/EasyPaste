<script setup lang="ts">import NavBar from "../../../components/NavBar.vue";import {computed} from "vue";import {openAboutWindow, openIconPreviewWindow, openSettingsWindow, openTagsWindow} from "../../../utils/WindowUtil.ts";import {exit, relaunch} from "@tauri-apps/plugin-process";import {currentThemeId, themes, toggleTheme} from "../../../services/ThemeService.ts";import {useMessage} from "naive-ui";import UpdaterService from "../../../services/UpdaterService.ts";import {tagSettingState} from "../composables/TagDataComposable.ts";import {showClearDataModal, toggleSearchBox} from "../composables/ClipboardDataComposable.ts";import {isDev} from "../../../data/SystemParams.ts";import {currentLanguage} from "../../../services/LanguageService.ts";// Naive UI 框架的消息组件const message = useMessage();// 顶部菜单const MenuItems = computed((): NavBarItem[] => [  {    key: '程序',    label: currentLanguage.value.pages.list.menu.program,    type: 'item',    children: [      {        key: '偏好设置',        label: currentLanguage.value.pages.list.menu.settings,        type: 'item',        onClick: () => {          // 打开设置窗口          openSettingsWindow();        }      },      {        key: 'divider1',        type: 'divider',      },      {        key: '重新加载',        label: currentLanguage.value.pages.list.menu.reload,        type: 'item',        onClick: async () => {          message.loading(currentLanguage.value.pages.list.menu.reloadHint);          // 重新加载应用程序          await relaunch();        }      },      {        key: '关闭',        label: currentLanguage.value.pages.list.menu.exit,        type: 'item',        onClick: async () => {          message.loading(currentLanguage.value.pages.list.menu.exitHint);          // 关闭应用程序          await exit(0);        }      },    ],  },  {    key: '数据',    label: currentLanguage.value.pages.list.menu.data,    type: 'item',    children: [      {        key: '标签管理',        label: currentLanguage.value.pages.list.menu.tagManger,        type: 'item',        onClick: () => {          // 打开标签管理窗口          openTagsWindow();        },        isHide: !tagSettingState.isShow,      },      {        key: '数据视图',        label: currentLanguage.value.pages.list.menu.dataView,        type: 'item',        isHide: true,      },      {        key: '搜索',        label: currentLanguage.value.pages.list.menu.search,        type: 'item',        onClick: () => {          toggleSearchBox();        }      },      {        key: 'divider2',        type: 'divider',      },      {        key: '清空剪贴板',        label: currentLanguage.value.pages.list.menu.clearData,        type: 'item',        onClick: async () => {          showClearDataModal.value = true        },      },      {        key: 'divider3',        type: 'divider',        isHide: true,      },      {        key: '数据导入',        label: currentLanguage.value.pages.list.menu.dataImport,        type: 'item',        isHide: true,      },      {        key: '数据导出',        label: currentLanguage.value.pages.list.menu.dataExport,        type: 'item',        isHide: true,      },    ],  },  {    key: '主题',    label: currentLanguage.value.pages.list.menu.themes,    type: 'item',    children: themes.map(theme => ({      key: `theme-${theme.id}`,      label: currentLanguage.value.pages.list.menu[theme.id],      type: 'radio',      onClick: async () => {        await toggleTheme(theme.id);      },      // 使用函数返回值，确保每次访问时都重新计算      get isCheck() {        return currentThemeId.value === theme.id;      }    })),  },  {    key: '帮助',    label: currentLanguage.value.pages.list.menu.help,    type: 'item',    children: [      {        key: '使用说明',        label: currentLanguage.value.pages.list.menu.instructions,        type: 'item',        isHide: true,      },      {        key: '更新日志',        label: currentLanguage.value.pages.list.menu.updateLog,        type: 'item',        isHide: true,      },      {        key: '检查更新',        label: currentLanguage.value.pages.list.menu.checkForUpdate,        type: 'item',        onClick: async () => {          // 调用检查更新接口          const update = UpdaterService.getInstance();          await update.checkForUpdates(true);        },      },      {        key: 'divider4',        type: 'divider',      },      {        key: '关于',        label: currentLanguage.value.pages.list.menu.about,        type: 'item',        onClick: () => {          // 打开关于窗口          openAboutWindow();        }      },      {        isHide: !isDev,        key: '程序图标预览',        label: '程序图标预览',        type: 'item',        onClick: () => {          // 打开程序图标预览窗口          openIconPreviewWindow();        }      },    ],  },]);</script><template>  <NavBar :menuItems="MenuItems"/></template><style scoped></style>