<template>  <div class="clipboard-item"       @dblclick="onCopy(props.item, message)"       :id="String(props.item.id)"       @contextmenu.prevent="onOpenContextMenu"  >    <div class="clipboard-card">      <!-- 头部 -->      <div class="card-header">        <div class="card-header-left">          <div class="item-type-icons">            <font-awesome-icon icon="fa-align-left" v-if="props.item.type === 'text'" class="item-type-icon"/>            <font-awesome-icon icon="fa-code" v-if="props.item.type === 'code'" class="item-type-icon"/>            <font-awesome-icon icon="fa-regular fa-image" v-if="props.item.type === 'image'" class="item-type-icon"/>            <font-awesome-icon icon="fa-link" v-if="props.item.type === 'link'" class="item-type-icon"/>            <font-awesome-icon icon="fa-regular fa-file" v-if="props.item.type === 'file'" class="item-type-icon"/>          </div>          <div class="card-title" v-if="displayDetailTime">{{ new Date(item.copy_time).toLocaleString() }}</div>          <div class="card-title" v-else>{{ getTimeAgo(item.copy_time) }}</div>          <div v-if="item.chars">{{ item.chars + ' ' + currentLanguage.pages.list.chars }}</div>        </div>        <div class="card-header-right">          <div class="card-header-right-buttons">            <!-- 置顶/取消置顶按钮 -->            <div class="card-header-right-button"                 @click="item.is_topped ? onUnTop(item.id, props.index) : onTop(item.id, props.index)">              <TopIcon v-if="!item.is_topped"/>              <UnTopIcon v-else/>            </div>            <!-- 删除按钮 -->            <div class="card-header-right-button" @click="removeItem(item, index, currentLanguage, message)">              <font-awesome-icon icon="fa-regular fa-trash-can"/>            </div>            <!-- 设置标签按钮 -->            <div                v-if="tagSettingState.isShow && tagSettingState.location === SETTINGS.TAG.BIND_TAG_LOCATION.TOP_RIGHT"                class="card-header-right-button drag-icon"                draggable="true"                @dragstart="handleDragStart(item, index, $event)"                @dragend="handleDragEnd"            >              <BindTagIcon class="dropdown-icon"/>            </div>          </div>        </div>      </div>      <!-- 内容 -->      <div class="card-content">        <div class="content-wrapper">          <!-- 普通文本 -->          <div v-if="item.type === 'text'"               class="text-line item-line"          >            {{ item.content }}          </div>          <!-- 代码 -->          <div v-else-if="item.type === 'code'"               class="code-line item-line"          >            <n-code :code="item.content" language="html" show-line-numbers/>          </div>          <!-- 链接 -->          <div v-else-if="item.type === 'link'"               class="link-line item-line"          >            <!-- 图标区域 -->            <div class="link-icon">              <div class="link-icon-block">                <font-awesome-icon icon="fa-link"/>              </div>            </div>            <!-- 文字内容 -->            <div class="link-content">              <div class="link-title">{{ item.link_title || currentLanguage.pages.list.linkNotTitle }}</div>              <div class="link-description">{{ item.content }}</div>            </div>          </div>          <!-- 文件 -->          <div v-else-if="item.type === 'file'" class="file-line item-line">            <FilePreview                v-for="filePath in JSON.parse(item.file_path)"                :title="filePath"                @dblclick="onCopyFile(item.id, filePath, message, currentLanguage)"                :is-exist="fileExistCache.get(filePath)"                :file-path="filePath"                :is-folder="isFolderCache.get(filePath)"                @contextmenu.prevent.stop="onOpenContextMenuByFile(filePath)"            />          </div>          <!-- 图片 -->          <div v-else-if="item.type === 'image'" class="image-line item-line">            <img v-if="displayThumbnailImage" :src="convertFileSrc(item.file_path)" class="image-preview"                 alt="图片预览失败"/>            <font-awesome-icon icon="fa-regular fa-image" class="file-icon" v-else/>          </div>          <!-- 空 -->          <div v-else class="item-line"></div>        </div>      </div>      <!-- 标签展示 -->      <transition-group name="tag-line"                        v-if="tagSettingState.isShow"                        :css="animationEffect.enabled">        <div class="card-tags" key="card-tags"             v-show="tagSettingState.location === SETTINGS.TAG.BIND_TAG_LOCATION.BOTTOM_RIGHT || (item.tags && item.tags.length > 0)">          <transition-group name="tag-item" :css="animationEffect.enabled">            <n-tag                size="small"                round                closable                bordered                v-for="tag in item.tags"                :key="tag.id"                class="item-tag"                @close="removeItemTag(item, tag, index, currentLanguage, message)"            >              <div class="item-tag-content">                <div :style="{ backgroundColor: tag.color }" class="item-tag-color"></div>                <div class="item-tag-name">                  {{ tag.name }}                </div>              </div>            </n-tag>          </transition-group>          <div              v-if="tagSettingState.isShow && tagSettingState.location === SETTINGS.TAG.BIND_TAG_LOCATION.BOTTOM_RIGHT"              class="bind-tag-button"              draggable="true"              @dragstart="handleDragStart(item, index, $event)"              @dragend="handleDragEnd"          >            <BindTagIcon class="bind-tag-icon"/>            <span v-if="tagSettingState.isShow">{{ currentLanguage.pages.list.bindTagBtn }}</span>          </div>        </div>      </transition-group>    </div>  </div></template><script setup lang="ts">import {NCode, NTag, useMessage} from 'naive-ui';import TopIcon from '../../../assets/icons/TopIcon.vue';import UnTopIcon from '../../../assets/icons/UnTopIcon.vue';import BindTagIcon from '../../../assets/icons/BindTagIcon.vue';import {  displayDetailTime,  onCopy,  onCopyFile,  onTop,  onUnTop,  removeItem,  removeItemTag} from "../composables/ClipboardDataComposable.ts";import {displayThumbnailImage, fileExistCache, isFolderCache} from "../composables/FileDataComposable.ts";import {handleDragEnd, handleDragStart} from "../composables/DragComposable.ts";import {tagSettingState} from "../composables/TagDataComposable.ts";import {SETTINGS} from "../../../constants/UserSettingsConstant.ts";import FilePreview from "./filePreview/FilePreview.vue";import {animationEffect} from "../../../components/composables/AnimationComposable.ts";import {currentLanguage} from "../../../services/LanguageService.ts";import {convertFileSrc} from "@tauri-apps/api/core";import {getTimeAgo} from "../../../utils/DateUtil.ts";// Naive UI 框架的消息组件const message = useMessage();const props = defineProps<{  item: ClipboardItem;  index: number;}>();/** * 获取父级的事件 */const emit = defineEmits(['custom-event']);function onOpenContextMenu() {  // 向父组件传递数据（可以是对象、字符串、数字等）  emit('custom-event', {    type: (props.item.type === 'text' || props.item.type === 'code') ? 'text' : props.item.type,    item: props.item,    filePath: props.item.type === 'image' ? props.item.file_path : '',    index: props.index  })}function onOpenContextMenuByFile(filePath: string) {  // 向父组件传递数据（可以是对象、字符串、数字等）  emit('custom-event', {    type: 'file',    item: props.item,    filePath: filePath,    index: props.index  })}</script><style scoped>.clipboard-item {  margin: 6px 6px;  transition: all var(--animation-duration, 0.3s) ease;  display: block;}.clipboard-card:hover {  background-color: var(--theme-universal-border);}.clipboard-card {  background-color: var(--theme-universal-secondary);  border-radius: 10px;  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);  padding: 7px;  transition: all var(--animation-duration, 0.3s) cubic-bezier(0.25, 0.8, 0.25, 1);  border: 1px solid transparent;}.clipboard-card:hover {  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);}.card-header {  display: flex;  flex-direction: row;  justify-content: space-between;  align-items: center;  color: var(--theme-universal-text);  font-size: 13px;  margin-bottom: 5px;}.card-header-left {  display: flex;  gap: 5px;  opacity: 0.5;}.item-type-icons {  width: 16px;  margin: 0 3px;  padding: 2px;  border: solid 1.5px var(--theme-universal-border);  display: flex;  align-items: center;  justify-content: center;  border-radius: 4px;}.item-type-icon {  color: var(--theme-universal-text);  width: 12px;}.card-header-right {  display: flex;}.card-header-right-buttons {  display: flex;  gap: 5px;}.card-header-right-button {  cursor: pointer;  width: 14px;  height: 14px;  display: flex;  align-items: center;  justify-content: center;  transition: transform var(--animation-duration, 0.3s);  opacity: 0.5;}.card-header-right-button:hover {  opacity: 0.8;}.drag-icon {  cursor: move !important;}.card-content {  color: var(--theme-universal-text);  word-break: break-all;  font-size: 0.9rem;  line-height: 1.4;}.content-wrapper {  display: flex;  justify-content: space-between;  align-items: flex-start;}.item-line {  display: -webkit-box;  -webkit-line-clamp: 3;  text-overflow: ellipsis;  line-clamp: 3;  overflow: auto;  height: 5.7em;  width: 100%;  word-wrap: break-word;  word-break: break-all;  font-size: 16px;  border: 2px solid var(--theme-universal-border);  border-radius: 8px;  padding: 5px;}.text-line {  white-space: pre-wrap;  user-select: text;}.code-line {  user-select: text;}.link-line {  display: flex;  align-items: center;  height: 3.4em !important;}.link-icon {  width: 16%;  display: flex;  align-items: center;  justify-content: center;  padding-right: 2%;}.link-icon-block {  width: 90%;  aspect-ratio: 1/1;  border-radius: 10px;  border: 1px solid var(--theme-universal-border);  background-color: var(--theme-universal-background);  display: flex;  align-items: center;  justify-content: center;}.link-content {  width: 84%;}.link-title {  white-space: nowrap; /* 禁止文本换行 */  overflow: hidden; /* 隐藏超出范围的内容 */  text-overflow: ellipsis; /* 使用省略号 */  font-size: 18px;  font-weight: 700;}.link-description {  white-space: nowrap; /* 禁止文本换行 */  overflow: hidden; /* 隐藏超出范围的内容 */  text-overflow: ellipsis; /* 使用省略号 */  color: var(--theme-universal-textHint);  font-size: 14px;}.file-line {}.image-line {}.image-preview {  object-fit: fill;  max-width: 100%;}.card-tags {  padding-top: 5px;  padding-bottom: 2px;  display: flex;  flex-wrap: wrap;  gap: 6px;}.item-tag {  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);}.item-tag-content {  display: flex;  flex-direction: row;  align-items: center;  justify-content: center;  gap: 3px;}.item-tag-color {  width: 12px;  height: 12px;  border-radius: 10px;  box-shadow: 0 0 3px rgba(0, 0, 0, 0.4);}.item-tag-name {  max-width: 60px;  overflow: hidden;  white-space: nowrap;  text-overflow: ellipsis;  word-break: break-all;}.bind-tag-button {  cursor: grab;  display: flex;  flex-direction: row;  align-items: center;  justify-content: center;  gap: 3px;  border: 1px dashed var(--theme-universal-text);  border-radius: 15px;  color: var(--theme-universal-text);  background-color: var(--theme-universal-background);  font-size: 11px;  padding: 0 8px;  opacity: 0.5;  margin-left: auto;  height: 22px;}.bind-tag-button:hover {  opacity: 0.8;}.bind-tag-icon {  width: 12px;  height: 12px;}/* 标签区域整体动画 */.tag-line-enter-from {  max-height: 0;  opacity: 0;}.tag-line-enter-to {  max-height: 200px; /* 根据实际需要调整 */  opacity: 1;}.tag-line-leave-from {  max-height: 200px; /* 根据实际需要调整 */  opacity: 1;}.tag-line-leave-to {  max-height: 0;  opacity: 0;}.tag-line-enter-active,.tag-line-leave-active {  transition: all var(--animation-duration, 0.3s) ease;  overflow: hidden;}/* 单个标签动画 */.tag-item-enter-from {  opacity: 0;  transform: scale(0.8);}.tag-item-enter-to {  opacity: 1;  transform: scale(1);}.tag-item-leave-from {  opacity: 1;  transform: scale(1);}.tag-item-leave-to {  opacity: 0;  transform: scale(0.8) translateX(-20px);}.tag-item-enter-active {  transition: all var(--animation-duration, 0.3s) ease 0.1s; /* 延迟进入动画，让容器先展开 */}.tag-item-leave-active {  transition: all var(--animation-duration, 0.3s) ease;}:deep(.n-divider:not(.n-divider--vertical)) {  margin-top: 0;  margin-bottom: 2px;}:deep(.n-divider__title) {  font-size: 13px;  font-weight: 400;  margin-left: 0;  margin-right: 0;}</style>