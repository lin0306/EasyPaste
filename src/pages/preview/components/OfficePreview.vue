<script setup lang="ts">import {convertFileSrc} from "@tauri-apps/api/core";import {computed, ref, watch} from "vue";import {isExcel, isPDF, isWord} from "../../../utils/OfficeUtil.ts";import VueOfficeDocx from '@vue-office/docx'import '@vue-office/docx/lib/index.css'import VueOfficeExcel, {Options} from '@vue-office/excel'import '@vue-office/excel/lib/index.css'import NonsupportPreview from "../../../assets/icons/NonsupportPreview.vue";import FileReadErrorPreview from "../../../assets/icons/FileReadErrorPreview.vue";import {useLanguage} from "../../../services/LanguageService.ts";const {currentLanguage} = useLanguage();const props = defineProps<{  filePath: string;}>();const isLoading = ref(true);const isLoadingFailed = ref(false);/** * excel参数 */const excelOptions = {  minColLength: 0,  // excel最少渲染多少列，如果想实现xlsx文件内容有几列，就渲染几列，可以将此值设置为0.  minRowLength: 0,  // excel最少渲染多少行，如果想实现根据xlsx实际函数渲染，可以将此值设置为0.  showContextmenu: false, // 显示右键菜单} as Options/** * 判断是否可以预览 */const isCanPreview = computed(() => {  const suffix = props.filePath.substring(props.filePath.lastIndexOf('.'));  const suffixLower = suffix.toLowerCase();  return suffixLower === '.pdf'      || suffixLower === '.docx'      || suffixLower === '.xlsx'      // || suffixLower === '.pptx'      ;});function renderedHandler() {  isLoading.value = false;  console.log("渲染成功");}function errorHandler() {  isLoadingFailed.value = true;  isLoading.value = false;  console.log("渲染失败")}watch(() => props.filePath, async () => {  isLoading.value = true;  isLoadingFailed.value = false;})</script><template>  <div v-if="!isCanPreview" class="no-preview-container">    <nonsupport-preview class="no-preview-icon"/>    <span class="no-preview-text">{{ currentLanguage.pages.preview.cannotPreviewOffice }}</span>  </div>  <iframe v-else-if="isPDF(props.filePath)"          :src="convertFileSrc(props.filePath)"          class="office-container"  />  <vue-office-docx v-else-if="isWord(props.filePath)"                   :src="convertFileSrc(props.filePath)"                   class="office-container"                   @rendered="renderedHandler"                   @error="errorHandler"  />  <vue-office-excel v-else-if="isExcel(props.filePath)"                    :src="convertFileSrc(props.filePath)"                    :options="excelOptions"                    class="office-container"                    @rendered="renderedHandler"                    @error="errorHandler"  />  <!-- TODO pptx预览 -->  <div v-if="isLoading && isCanPreview" class="no-preview-container">    <n-spin/>  </div>  <div v-if="isLoadingFailed" class="no-preview-container">    <file-read-error-preview class="no-preview-icon"/>    <span class="no-preview-text">{{ currentLanguage.pages.preview.fileReadFailed }}</span>  </div></template><style scoped>.office-container {  width: 100%;  height: 100%;  border: 0;  overflow-y: auto;}</style>