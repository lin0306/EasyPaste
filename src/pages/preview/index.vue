<script setup lang="ts">import {destroyFileView, filePath, initFileView, isFolder} from "./composables/FileViewDataComposable.ts";import TitleBar from "../../components/TitleBar.vue";import {useLanguage} from "../../services/LanguageService.ts";import {onMounted, onUnmounted} from "vue";import {isImage} from "../../utils/ImageUtil.ts";import {filePathConvertFileName} from "../../utils/TextUtil.ts";import VideoPreview from "./components/VideoPreview.vue";import ImagePreview from "./components/ImagePreview.vue";import {isVideo} from "../../utils/VideoUtil.ts";import UnknownFileIcon from "../../assets/icons/UnknownFileIcon.vue";import {invoke} from "@tauri-apps/api/core";import {isMac} from "../../data/SystemParams.ts";import CodePreview from "./components/CodePreview.vue";import {isCode} from "../../utils/CodeUtil.ts";import {isAudio} from "../../utils/AudioUtil.ts";import AudioPreview from "./components/AudioPreview.vue";import FolderPreview from "./components/FolderPreview.vue";import OfficePreview from "./components/OfficePreview.vue";import {isOffice} from "../../utils/OfficeUtil.ts";import TextPreview from "./components/text/TextPreview.vue";import {isText} from "../../utils/TextUtil.ts";import PackagePreview from "./components/PackagePreview.vue";import {isPackage} from "../../utils/PackageUtil.ts";import OpenFolderLocationIcon from "../../assets/icons/OpenFolderLocationIcon.vue";const {currentLanguage} = useLanguage();/** * 打开文件所在目录 */async function openInFolder() {  const f = filePath.value;  // 获取文件所在目录  const path = f.toLowerCase().split('.').pop() ? f.substring(0, f.lastIndexOf(isMac ? "/" : "\\")) : filePath;  await invoke('open_folder', {path: path})}onMounted(async () => {  await initFileView();})onUnmounted(() => {  destroyFileView();})</script><template>  <TitleBar :title="currentLanguage.pages.preview.title"            :showCloseBtn="true"            :dev-tool="`preview`"/>  <div class="viewer-container">    <div class="viewer-header">      <div class="viewer-file-path">{{ currentLanguage.pages.preview.filePathLabel }}        {{ filePathConvertFileName(filePath) }}      </div>      <open-folder-location-icon @click="openInFolder" class="folder-icon"/>    </div>    <n-divider/>    <div class="viewer-content">      <folder-preview v-if="isFolder" :file-path="filePath"/>      <image-preview v-else-if="isImage(filePath)" :file-path="filePath"/>      <video-preview v-else-if="isVideo(filePath)" :file-path="filePath"/>      <audio-preview v-else-if="isAudio(filePath)" :file-path="filePath"/>      <code-preview v-else-if="isCode(filePath)" :file-path="filePath"/>      <office-preview v-else-if="isOffice(filePath)" :file-path="filePath"/>      <text-preview v-else-if="isText(filePath)" :file-path="filePath"/>      <package-preview v-else-if="isPackage(filePath)" :file-path="filePath"/>      <div v-else class="unknown-file-container">        <unknown-file-icon class="unknown-file-icon"/>        <span class="unknown-file-text">          文件暂不支持预览，请点击右上角打开文件所在位置进行浏览        </span>      </div>    </div>  </div></template><style scoped>.viewer-container {  margin: 15px;  overflow-y: auto;}.viewer-header {  display: flex;  justify-content: space-between;  gap: 6px;  width: 100%;}.viewer-file-path {  line-height: normal;}.folder-icon {  width: 25px;  opacity: 0.6;}.folder-icon:hover {  opacity: 1;}:deep(.n-divider:not(.n-divider--vertical)) {  margin-top: 5px !important;  margin-bottom: 7px !important;}.viewer-content {  padding: 5px;  height: calc(100vh - 95px);}.unknown-file-container {  width: 100%;  height: 100%;  display: flex;  flex-direction: column;  justify-content: center;  align-items: center;}.unknown-file-icon {  width: 40%;  height: auto;  opacity: 0.8;}.unknown-file-text {  width: 70%;  text-align: center;  font-size: 16px;  opacity: 0.8;}</style>