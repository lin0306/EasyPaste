<script setup lang="ts">import {useMessage} from 'naive-ui';import TitleBar from '../../components/TitleBar.vue';import {useLanguage} from '../../services/LanguageService.ts';import {onMounted, onUnmounted, watch} from "vue";import {getSettings} from "../../services/FileService.ts";import {clipboardListenStore} from "../../store/copyStatus.ts";import {error} from "@tauri-apps/plugin-log";import {CopyState} from "../../types/CopyState.ts";import {  destroyClipboardDataContext,  initializeClipboardDataContext,  insertClipboardItem} from "./context/ClipboardDataContext.ts";import {destroyTagContext, initializeTagContext} from "./context/TagDataContext.ts";import HeadNavigationBar from "./components/HeadNavigationBar.vue";import {destroyWindowContext, initializeWindowContext, isAutoHideWindow} from "./context/WindowContext.ts";import {destroyUpdaterContext, hasNewVersion, initializeUpdaterContext} from "./context/UpdaterContext.ts";import SearchBox from './components/SearchBox.vue';import TagList from './components/TagList.vue';import ClipboardListContent from './components/ClipboardListContent.vue';// 获取语言上下文const {currentLanguage} = useLanguage();// Naive UI 框架的消息组件const message = useMessage();// 监听系统复制状态const clipboardListen = clipboardListenStore();// 监听系统是否复制内容watch(() => clipboardListen.state, (newValue, oldValue) => {  if (      newValue !== oldValue      && newValue === CopyState.SUCCESS      && oldValue === CopyState.COPING  ) {    console.log("检测到剪贴板有更新，插入新数据");    insertClipboardItem(clipboardListen.getItem());  }});/** * 组件初始化挂载监听 */onMounted(async () => {  try {    const settings = await getSettings();    // 初始化剪贴板数据上下文    await initializeClipboardDataContext(settings);    // 初始化标签上下文    await initializeTagContext(settings);    // 初始化窗口上下文    await initializeWindowContext(settings, currentLanguage.value);    // 初始化更新器上下文    await initializeUpdaterContext(settings);  } catch (err) {    console.error(err);    error('初始化失败:' + err);    message.error(currentLanguage.value.pages.list.initFailedHint);  }})/** * 组件卸载时清除事件监听 */onUnmounted(async () => {  // 销毁剪贴板数据上下文  await destroyClipboardDataContext();  // 销毁标签上下文  destroyTagContext();  // 销毁窗口上下文  destroyWindowContext();  // 销毁更新器上下文  destroyUpdaterContext();})</script><template>  <TitleBar      :title="currentLanguage.pages.list.title"      :showFixedBtn="true"      :show-hide-btn="!isAutoHideWindow"      :dev-tool="`main`"      :show-update-icon="hasNewVersion"  />  <HeadNavigationBar/>  <!-- 搜索框 -->  <SearchBox/>  <!-- 标签列表 -->  <TagList/>  <!-- 数据列表 -->  <ClipboardListContent/></template>