<script setup lang="ts">import NavBar from "../../../components/NavBar.vue";import {computed} from "vue";import {NavBarItem} from "../../../types/NavBarItem.ts";import {useLanguage} from "../../../services/LanguageService.ts";import {openAboutWindow, openSettingsWindow, openTagsWindow} from "../../../utils/window.ts";import {exit, relaunch} from "@tauri-apps/plugin-process";import ClipboardDBService from "../../../services/ClipboardDBService.ts";import {themes, useTheme} from "../../../services/ThemeService.ts";import {useMessage} from "naive-ui";import UpdaterService from "../../../services/UpdaterService.ts";import {tagSettingState} from "../composables/TagDataComposable.ts";import {clipboardItems, toggleSearchBox} from "../composables/ClipboardDataComposable.ts";// 获取语言上下文const {currentLanguage} = useLanguage();// 获取主题上下文const {currentThemeId, toggleTheme} = useTheme();// Naive UI 框架的消息组件const message = useMessage();// 顶部菜单const MenuItems = computed((): NavBarItem[] => [  {    key: '程序',    label: currentLanguage.value.pages.list.menu.program,    children: [      {        key: '偏好设置',        label: currentLanguage.value.pages.list.menu.settings,        onClick: () => {          // 打开设置窗口          openSettingsWindow();        }      },      {        type: 'divider',      },      {        key: '重新加载',        label: currentLanguage.value.pages.list.menu.reload,        onClick: async () => {          message.loading(currentLanguage.value.pages.list.menu.reloadHint);          // 重新加载应用程序          await relaunch();        }      },      {        key: '关闭',        label: currentLanguage.value.pages.list.menu.exit,        onClick: async () => {          message.loading(currentLanguage.value.pages.list.menu.exitHint);          // 关闭应用程序          await exit(0);        }      },    ],  },  {    key: '数据',    label: currentLanguage.value.pages.list.menu.data,    children: [      {        key: '标签管理',        label: currentLanguage.value.pages.list.menu.tagManger,        onClick: () => {          // 打开标签管理窗口          openTagsWindow();        },        isHide: !tagSettingState.isShow,      },      {        key: '数据视图',        label: currentLanguage.value.pages.list.menu.dataView,        isHide: true,      },      {        key: '搜索',        label: currentLanguage.value.pages.list.menu.search,        onClick: () => {          toggleSearchBox();        }      },      {        type: 'divider',      },      {        key: '清空剪贴板',        label: currentLanguage.value.pages.list.menu.clearData,        onClick: async () => {          // 清空历史记录          try {            const db = await ClipboardDBService.getInstance();            await db.clearAll();            clipboardItems.value = []            message.success(currentLanguage.value.pages.list.menu.clearDataSuccessMsg)          } catch (error) {            message.error(currentLanguage.value.pages.list.menu.clearDataFailedMsg)          }        },      },      {        type: 'divider',        isHide: true,      },      {        key: '数据导入',        label: currentLanguage.value.pages.list.menu.dataImport,        isHide: true,      },      {        key: '数据导出',        label: currentLanguage.value.pages.list.menu.dataExport,        isHide: true,      },    ],  },  {    key: '主题',    label: currentLanguage.value.pages.list.menu.themes,    children: themes.map(theme => ({      key: `theme-${theme.id}`,      label: currentLanguage.value.pages.list.menu[theme.id],      type: 'theme',      onClick: async () => {        await toggleTheme(theme.id);      },      // 使用函数返回值，确保每次访问时都重新计算      get isCurrentTheme() {        return currentThemeId.value === theme.id;      }    })),  },  {    key: '帮助',    label: currentLanguage.value.pages.list.menu.help,    children: [      {        key: '使用说明',        label: currentLanguage.value.pages.list.menu.instructions,        isHide: true,      },      {        key: '更新日志',        label: currentLanguage.value.pages.list.menu.updateLog,        isHide: true,      },      {        key: '检查更新',        label: currentLanguage.value.pages.list.menu.checkForUpdate,        onClick: async () => {          // 调用检查更新接口          const update = UpdaterService.getInstance();          await update.checkForUpdates(true);        },      },      {        type: 'divider',      },      {        key: '关于',        label: currentLanguage.value.pages.list.menu.about,        onClick: () => {          // 打开关于窗口          openAboutWindow();        }      },    ],  },]);</script><template>  <NavBar :menuItems="MenuItems"/></template><style scoped></style>