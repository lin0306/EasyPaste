<template>  <div class="clipboard-item" @dblclick="onCopy(props.item, message, currentLanguage)" :id="props.item.id">    <div class="clipboard-card">      <!-- 头部 -->      <div class="card-header">        <div class="card-header-left">          <div>{{ getTypeText(props.item) }}</div>          <div class="card-title">{{ new Date(item.copy_time).toLocaleString() }}</div>          <div v-if="item.chars">{{ item.chars + ' ' + currentLanguage.pages.list.chars }}</div>        </div>        <div class="card-header-right">          <div class="card-header-right-buttons">            <!-- 置顶/取消置顶按钮 -->            <div class="card-header-right-button" @click="item.is_topped ? onUnTop(item.id) : onTop(item.id)">              <TopIcon v-if="!item.is_topped"/>              <UnTopIcon v-else/>            </div>            <!-- 删除按钮 -->            <div class="card-header-right-button" @click="removeItem(item.id, index)">              <TrashIcon/>            </div>            <!-- 设置标签按钮 -->            <div                v-if="tagSettingState.isShow && tagSettingState.location === SETTINGS.GENERATE.BIND_TAG_LOCATION.TOP_RIGHT"                class="card-header-right-button drag-icon"                draggable="true"                @dragstart="handleDragStart(item, index, $event)"                @dragend="handleDragEnd"            >              <AddTagIcon class="dropdown-icon"/>            </div>          </div>        </div>      </div>      <!-- 内容 -->      <div class="card-content">        <div class="content-wrapper">          <!-- 普通文本 -->          <div v-if="item.type === 'text'"               class="text-line item-line"               draggable="true"               @dragstart="contentDragStart(item, $event)"          >            {{ item.content }}          </div>          <!-- 代码 -->          <div v-else-if="item.type === 'code'"               class="code-line item-line"               draggable="true"               @dragstart="contentDragStart(item, $event)"          >            <n-code :code="item.content" language="html" show-line-numbers/>          </div>          <!-- 文件 -->          <div v-else-if="item.type === 'file'" class="file-line item-line">            <FilePreview                v-for="filePath in JSON.parse(item.file_path)"                :title="filePath"                @dblclick="onCopyFile(item.id, filePath, message, currentLanguage)"                :is-exist="fileExistCache.get(filePath)"                :file-path="filePath"                :is-folder="isFolderCache.get(filePath)"            />          </div>          <!-- 空 -->          <div v-else class="item-line"></div>        </div>      </div>      <!-- 标签展示 -->      <transition-group name="tag-line" v-if="tagSettingState.isShow" :css="animationEffect.enabled">        <div class="card-tags" key="card-tags">          <transition-group name="tag-item" :css="animationEffect.enabled">            <n-tag                size="small"                round                closable                bordered                v-for="tag in item.tags"                :key="tag.id"                class="item-tag"                @close="removeItemTag(item, tag, index)"            >              <div class="item-tag-content">                <div :style="{ backgroundColor: tag.color }" class="item-tag-color"></div>                <div class="item-tag-name">                  {{ tag.name }}                </div>              </div>            </n-tag>          </transition-group>          <div              v-if="tagSettingState.isShow && tagSettingState.location === SETTINGS.GENERATE.BIND_TAG_LOCATION.BOTTOM_RIGHT"              class="bind-tag-button"              draggable="true"              @dragstart="handleDragStart(item, index, $event)"              @dragend="handleDragEnd"          >            <AddTagIcon class="bind-tag-icon"/>            <span v-if="tagSettingState.isShow">绑定标签</span>          </div>        </div>      </transition-group>    </div>  </div></template><script setup lang="ts">import {NCode, NTag, useMessage} from 'naive-ui';import TopIcon from '../../../assets/icons/TopIcon.vue';import UnTopIcon from '../../../assets/icons/UnTopIcon.vue';import TrashIcon from '../../../assets/icons/TrashIcon.vue';import AddTagIcon from '../../../assets/icons/AddTagIcon.vue';import {useLanguage} from "../../../services/LanguageService.ts";import {onCopy, onCopyFile, onTop, onUnTop, removeItem, removeItemTag} from "../composables/ClipboardDataComposable.ts";import {fileExistCache, isFolderCache} from "../composables/FileDataComposable.ts";import {contentDragStart, handleDragEnd, handleDragStart} from "../composables/DragComposable.ts";import {tagSettingState} from "../composables/TagDataComposable.ts";import {SETTINGS} from "../../../constants/UserSettingsConstant.ts";import {animationEffect} from "../composables/AnimationComposable.ts";import FilePreview from "../../../components/FilePreview.vue";// 获取语言上下文const {currentLanguage} = useLanguage();// Naive UI 框架的消息组件const message = useMessage();const props = defineProps<{  item: any;  index: number;}>();function getTypeText(item: ClipboardItem) {  switch (item.type) {    case 'text':      return currentLanguage.value.pages.list.typeText;    case 'code':      return currentLanguage.value.pages.list.typeCode;    case 'file':      return currentLanguage.value.pages.list.typeFile;    default:      return currentLanguage.value.pages.list.typeText;  }}</script><style scoped>.clipboard-item {  margin: 6px 6px;  transition: all var(--animation-duration, 0.3s) ease;  display: block;}.clipboard-card:hover {  background-color: var(--theme-border);}.clipboard-card {  background-color: var(--theme-cardBackground);  border-radius: 10px;  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);  padding: 7px;  transition: all var(--animation-duration, 0.3s) cubic-bezier(0.25, 0.8, 0.25, 1);  border: 1px solid transparent;}.clipboard-card:hover {  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);}.card-header {  display: flex;  flex-direction: row;  justify-content: space-between;  align-items: center;  color: var(--theme-text);  padding-bottom: 5px;  font-size: 12px;  border-bottom: 1px solid var(--theme-border);}.card-header-left {  display: flex;  gap: 5px;  opacity: 0.5;}.card-header-right {  display: flex;}.card-header-right-buttons {  display: flex;  gap: 5px;}.card-header-right-button {  cursor: pointer;  width: 14px;  height: 14px;  display: flex;  align-items: center;  justify-content: center;  transition: transform var(--animation-duration, 0.3s);  opacity: 0.5;}.card-header-right-button:hover {  opacity: 0.8;}.drag-icon {  cursor: move !important;}.card-content {  color: var(--theme-text);  word-break: break-all;  font-size: 0.9rem;  line-height: 1.4;  margin: 5px 0;}.content-wrapper {  display: flex;  justify-content: space-between;  align-items: flex-start;}.item-line {  display: -webkit-box;  -webkit-line-clamp: 3;  text-overflow: ellipsis;  line-clamp: 3;  overflow: hidden;  height: 5.7em;  width: 100%;  word-wrap: break-word;  word-break: break-all;  font-size: 16px;}.text-line {  white-space: pre-wrap;  overflow: auto;}.code-line {  overflow: auto;  height: 5.7em;}.code-line::-webkit-scrollbar {  border-radius: 10px;  height: 6px;}.file-line {  overflow: auto !important;}.file-line::-webkit-scrollbar {  border-radius: 10px;  height: 6px;}.card-tags {  border-top: 1px solid var(--theme-border);  padding-top: 5px;  padding-bottom: 2px;  display: flex;  flex-wrap: wrap;  gap: 6px;}.item-tag {  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);}.item-tag-content {  display: flex;  flex-direction: row;  align-items: center;  justify-content: center;  gap: 3px;}.item-tag-color {  width: 12px;  height: 12px;  border-radius: 10px;  box-shadow: 0 0 3px rgba(0, 0, 0, 0.4);}.item-tag-name {  max-width: 60px;  overflow: hidden;  white-space: nowrap;  text-overflow: ellipsis;  word-break: break-all;}.bind-tag-button {  cursor: grab;  display: flex;  flex-direction: row;  align-items: center;  justify-content: center;  gap: 3px;  border: 1px dashed var(--theme-text);  border-radius: 15px;  padding: 3px;  color: var(--theme-text);  background-color: var(--theme-background);  font-size: 11px;  padding: 0px 8px;  opacity: 0.6;  margin-left: auto;}.bind-tag-button:hover {  opacity: 1;}.bind-tag-icon {  width: 12px;  height: 12px;}/* 标签区域整体动画 */.tag-line-enter-from {  max-height: 0;  opacity: 0;}.tag-line-enter-to {  max-height: 200px; /* 根据实际需要调整 */  opacity: 1;}.tag-line-leave-from {  max-height: 200px; /* 根据实际需要调整 */  opacity: 1;}.tag-line-leave-to {  max-height: 0;  opacity: 0;}.tag-line-enter-active,.tag-line-leave-active {  transition: all var(--animation-duration, 0.3s) ease;  overflow: hidden;}/* 单个标签动画 */.tag-item-enter-from {  opacity: 0;  transform: scale(0.8);}.tag-item-enter-to {  opacity: 1;  transform: scale(1);}.tag-item-leave-from {  opacity: 1;  transform: scale(1);}.tag-item-leave-to {  opacity: 0;  transform: scale(0.8) translateX(-20px);}.tag-item-enter-active {  transition: all var(--animation-duration, 0.3s) ease 0.1s; /* 延迟进入动画，让容器先展开 */}.tag-item-leave-active {  transition: all var(--animation-duration, 0.3s) ease;}</style>