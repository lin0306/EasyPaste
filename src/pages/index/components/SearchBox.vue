<template>  <transition-group name="search" :css="animationEffect.enabled">    <div class="search-container"         v-if="searchBoxState.visible"         key="search"    >      <n-input          id="search-input"          v-model:value="searchBoxState.text"          :placeholder="currentLanguage.pages.list.searchHint"          clearable          @input="loadClipboardItems(true)"          size="small"          key="search-input"      >        <template #prefix>          <n-icon size="18">            <SearchIcon/>          </n-icon>        </template>      </n-input>    </div>  </transition-group></template><script setup lang="ts">import {NIcon, NInput} from 'naive-ui';import SearchIcon from '../../../assets/icons/SearchIcon.vue';import {useLanguage} from "../../../services/LanguageService.ts";import {loadClipboardItems, searchBoxState, toggleSearchBox} from "../composables/ClipboardDataComposable.ts";import {onMounted, onUnmounted} from "vue";import {getSearchKey} from "../../../store/ShortcutKeys.ts";import {animationEffect} from "../composables/IndexAnimationComposable.ts";// 获取语言上下文const {currentLanguage} = useLanguage();/** * 处理键盘事件 * @param {KeyboardEvent} event - 键盘事件 */let lastKeyDownTime = 0;async function handleKeyDown(event: KeyboardEvent) {  // 忽略重复的按键事件  if (event.timeStamp - lastKeyDownTime < 100) {    return;  }  lastKeyDownTime = event.timeStamp;  // 如果设置的搜索快捷键是ctrl + f，则优先触发搜索，mac是command + f  if (event.key.toLowerCase() === 'f' && (event.ctrlKey || event.metaKey)) {    event.preventDefault();    event.stopPropagation();  }  const searchKey = await getSearchKey();  // 如果没有快捷键配置，则不处理  if (!searchKey) return;  // 当搜索框显示时，按ESC键隐藏  if (searchBoxState.visible && event.key === 'Escape') {    event.preventDefault(); // 阻止默认行为    toggleSearchBox();    return;  }  const keys: string[] = searchKey.key;  let isCtrl = keys.includes("ctrl");  let isAlt = keys.includes("alt");  let isShift = keys.includes("shift");  // mac上是command键，windows上是win键  let isMeta = keys.includes("meta");  let character = keys[keys.length - 1];  if (      event.key.toLowerCase() === character.toLowerCase()      && event.ctrlKey === isCtrl      && event.altKey === isAlt      && event.shiftKey === isShift      && event.metaKey === isMeta  ) {    event.preventDefault(); // 阻止默认行为    toggleSearchBox();    return;  }}/** * 组件初始化挂载监听 */onMounted(() => {  // 增加事件监听  document.addEventListener('keydown', handleKeyDown);})/** * 组件卸载时清除事件监听 */onUnmounted(() => {  // 移除事件监听  document.removeEventListener('keydown', handleKeyDown);})</script><style scoped>.search-container {  z-index: 100;  height: 30px;  width: 95%;  margin-bottom: 4px;  background-color: var(--theme-cardBackground);  border-radius: 0 0 8px 8px;  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);  padding: 8px;  overflow: hidden;  position: fixed;  transition: all var(--animation-duration, 0.3s) ease;}/* 显示时从上往下滑入 */.search-enter-from {  transform: translateY(-50px);}.search-enter-to {  transform: translateY(0);}.search-leave-from {  transform: translateY(0);}.search-leave-to {  transform: translateY(-50px);}/* 显示时，高度动画先执行，输入框稍后淡入 */.search-enter-active,.search-leave-active{  transition: all var(--animation-duration, 0.3s) ease;}.search-container .n-input {  border-radius: 4px;  border: 1px solid var(--theme-border);  background-color: var(--theme-background);}.search-container .n-input__input {  color: var(--theme-textHint);}</style>