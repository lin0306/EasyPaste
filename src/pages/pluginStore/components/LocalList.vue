<script setup lang="ts">import VersionIcon from "../icons/VersionIcon.vue";import WindowsIcon from "../icons/WindowsIcon.vue";import PluginIcon from "../icons/PluginIcon.vue";import MacIcon from "../icons/MacIcon.vue";import {  hasUpdate,  loadingSet, localListLoading,  localPlugins,  onSelectLocal,  selectedPlugin,  tabValue,  togglePluginEnable,  update} from "../composables/PluginComponsables.ts";import {useMessage} from "naive-ui";import {themeColors} from "../../../services/ThemeService.ts";import {currentLanguage} from "../../../services/LanguageService.ts";const message = useMessage();/** * 插件更新 * @param plugin 本地插件 */async function onUpdate(plugin: LocalPlugin) {  loadingSet.value.add(plugin.plugin_id);  onSelectLocal(plugin);  await update(plugin.plugin_id, message);  loadingSet.value.delete(plugin.plugin_id);}</script><template>  <div class="plugin-list">    <div v-if="localListLoading" class="loading">      <n-spin size="large"/>    </div>    <div        v-else-if="localPlugins && localPlugins.length > 0"        class="plugin-item"        v-for="plugin in localPlugins"        :key="plugin.id" :class="{'item-selected': selectedPlugin && selectedPlugin.id === plugin.id}"        @click="onSelectLocal(plugin)"    >      <div class="plugin-item-icon">        <plugin-icon class="plugin-icon"/>      </div>      <div class="plugin-item-content">        <div class="plugin-title">          <div class="plugin-name">{{ plugin.plugin_name }}</div>          <n-tag              round              :bordered="false"              size="small"              v-if="plugin.platform !== 'General'"              :color="	{ color: themeColors.universal.border, textColor: themeColors.universal.text }"          >            <span v-if="plugin.platform === 'Windows'">Windows</span>            <span v-if="plugin.platform === 'Mac'">Mac</span>            <template #avatar>              <windows-icon v-if="plugin.platform === 'Windows'" class="platform-icon"/>              <mac-icon v-if="plugin.platform === 'Mac'" class="platform-icon"/>            </template>          </n-tag>        </div>        <div class="plugin-info">          <div class="plugin-version">            <version-icon class="version-icon"/>            {{ plugin.version }}          </div>        </div>      </div>      <div class="plugin-item-btn">        <n-spin size="small" v-if="loadingSet.has(plugin.plugin_id)"/>        <n-button            round            type="primary"            size="small"            v-else-if="hasUpdate(plugin.plugin_id)"            @click="onUpdate(plugin)"        >          {{ currentLanguage.pages.pluginStore.updateBtn }}        </n-button>        <n-button            round            size="small"            v-else-if="plugin.enable === 1"            @click="togglePluginEnable(plugin.plugin_id, false)"        >          {{ currentLanguage.pages.pluginStore.disableBtn }}        </n-button>        <n-button            round            size="small"            v-else            @click="togglePluginEnable(plugin.plugin_id, true)"        >          {{ currentLanguage.pages.pluginStore.enableBtn }}        </n-button>      </div>    </div>    <div v-else class="no-plugins-container">      <n-button text @click="tabValue = 'store'">        {{ currentLanguage.pages.pluginStore.localNoPluginHint }}      </n-button>    </div>  </div></template><style scoped>.loading {  display: flex;  width: 100%;  height: 100vh;  align-content: center;  justify-content: center;}</style>