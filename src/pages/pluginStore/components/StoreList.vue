<script setup lang="ts">import {themeColors} from "../../../services/ThemeService.ts";import {convertFileSize} from "../../../utils/FileUtil.ts";import VersionIcon from "../icons/VersionIcon.vue";import WindowsIcon from "../icons/WindowsIcon.vue";import PluginIcon from "../icons/PluginIcon.vue";import MacIcon from "../icons/MacIcon.vue";import {  hasUpdate,  install,  isInstall,  loadingSet,  onSelectStore,  pluginStore,  selectedPlugin,  storeListLoading, update} from "../composables/PluginComponsables.ts";import {useMessage} from "naive-ui";import {currentLanguage} from "../../../services/LanguageService.ts";const message = useMessage();async function onInstall(plugin: StorePlugin) {  await install(plugin.id, message);}async function onUpdate(plugin: StorePlugin) {  await update(plugin.id, message);}</script><template>  <div class="plugin-list">    <div v-if="storeListLoading" class="loading">      <n-spin size="large"/>    </div>    <div        v-else-if="pluginStore && pluginStore.length > 0"        class="plugin-item"        v-for="plugin in pluginStore"        :key="plugin.id"        :class="{'item-selected': selectedPlugin && selectedPlugin.plugin_id === plugin.id}"        @click="onSelectStore(plugin)"    >      <div class="plugin-item-icon">        <plugin-icon class="plugin-icon"/>      </div>      <div class="plugin-item-content">        <div class="plugin-title">          <div class="plugin-name">{{ plugin.name }}</div>          <n-tag              round              :bordered="false"              size="small"              v-if="plugin.platform !== 'General'"              :color="	{ color: themeColors.universal.border, textColor: themeColors.universal.text }"          >            <span v-if="plugin.platform === 'Windows'">Windows</span>            <span v-if="plugin.platform === 'Mac'">Mac</span>            <template #avatar>              <windows-icon v-if="plugin.platform === 'Windows'" class="platform-icon"/>              <mac-icon v-if="plugin.platform === 'Mac'" class="platform-icon"/>            </template>          </n-tag>        </div>        <div class="plugin-info">          <div class="plugin-size">{{ convertFileSize(plugin.size) }}</div>          <div class="plugin-version">            <version-icon class="version-icon"/>            {{ plugin.version }}          </div>        </div>      </div>      <div class="plugin-item-btn">        <n-spin size="small" v-if="loadingSet.has(plugin.id)"/>        <n-button            round            type="primary"            size="small"            v-else-if="hasUpdate(plugin.id)"            @click="onUpdate(plugin)"        >          {{ currentLanguage.pages.pluginStore.updateBtn }}        </n-button>        <n-button            round            ghost            size="small"            v-else-if="!isInstall(plugin.id)"            @click="onInstall(plugin)"        >          {{ currentLanguage.pages.pluginStore.installBtn }}        </n-button>        <n-button            round            quaternary            size="small"            disabled            v-else        >          {{ currentLanguage.pages.pluginStore.installedBtn }}        </n-button>      </div>    </div>    <div v-else class="no-plugins-container">      {{ currentLanguage.pages.pluginStore.storeNoPluginHint }}    </div>  </div></template><style scoped>.loading {  display: flex;  width: 100%;  height: 100vh;  align-content: center;  justify-content: center;}</style>