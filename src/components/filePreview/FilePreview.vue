<script setup lang="ts">import {isPackage, isProgram, isTXT} from "../../utils/FileTypeUtil.ts";import PptIcon from "./icons/PptIcon.vue";import WordIcon from "./icons/WordIcon.vue";import TxtIcon from "./icons/TxtIcon.vue";import FileIcon from "./icons/FileIcon.vue";import ExcelIcon from "./icons/ExcelIcon.vue";import PdfIcon from "./icons/PdfIcon.vue";import FolderIcon from "./icons/FolderIcon.vue";import {NImage} from "naive-ui";import FileDeleteIcon from "./icons/FileDeleteIcon.vue";import {filePathConvertFileName} from "../../utils/strUtil.ts";import PreviewIcon from "./icons/PreviewIcon.vue";import {ref} from "vue";import {createWin} from "../../utils/WindowUtil.ts";import {WebviewWindow} from "@tauri-apps/api/webviewWindow";import {emit} from "@tauri-apps/api/event";import {convertFileSrc} from "@tauri-apps/api/core";import VideoIcon from "./icons/VideoIcon.vue";import {isVideo} from "../../utils/VideoUtil.ts";import {isImage} from "../../utils/ImageUtil.ts";import AudioIcon from "./icons/AudioIcon.vue";import ExeIcon from "./icons/ExeIcon.vue";import PackageIcon from "./icons/PackageIcon.vue";import CodeIcon from "./icons/CodeIcon.vue";import {isCode} from "../../utils/CodeUtil.ts";import {isAudio} from "../../utils/AudioUtil.ts";import {isExcel, isPDF, isPPT, isWord} from "../../utils/OfficeUtil.ts";const props = defineProps<{  filePath: string;  isFolder?: boolean;  isExist?: boolean;}>();const isPreview = ref(false);/** * 鼠标移入预览 */function onMouseOver() {  isPreview.value = true;}/** * 鼠标移出取消预览 */function onMouseOut() {  isPreview.value = false;}/** * 文件预览 */async function onPreview() {  const existWin = await WebviewWindow.getByLabel("preview");  if (existWin) {    await emit('reload-preview', {filePath: props.filePath, isFolder: props.isFolder});    await existWin.show();    await existWin.setFocus();  } else {    await createWin({      label: 'preview',      url: '/preview?filePath=' + props.filePath + '&isFolder=' + props.isFolder,      width: 600,      height: 500,      resizable: true,      visible: true,    });  }}</script><template>  <div class="file-item" @mouseover="onMouseOver" @mouseout="onMouseOut">    <file-delete-icon class="file-not-exist-icon" v-if="!isExist"/>    <folder-icon class="file-icon" v-else-if="isFolder"/>    <n-image        v-else-if="isImage(props.filePath)"        :src="convertFileSrc(props.filePath)"        object-fit="cover"        height="60px"        width="100%"        :lazy="true"        :preview-disabled="true"    />    <video-icon class="file-icon" v-else-if="isVideo(props.filePath)"/>    <audio-icon class="file-icon" v-else-if="isAudio(props.filePath)"/>    <word-icon class="file-icon" v-else-if="isWord(props.filePath)"/>    <excel-icon class="file-icon" v-else-if="isExcel(props.filePath)"/>    <ppt-icon class="file-icon" v-else-if="isPPT(props.filePath)"/>    <pdf-icon class="file-icon" v-else-if="isPDF(props.filePath)"/>    <txt-icon class="file-icon" v-else-if="isTXT(props.filePath)"/>    <exe-icon class="file-icon" v-else-if="isProgram(props.filePath)"/>    <package-icon class="file-icon" v-else-if="isPackage(props.filePath)"/>    <code-icon class="file-icon" v-else-if="isCode(props.filePath)"/>    <file-icon class="file-icon" v-else/>    <span :class="{'file-not-exist-text':!props.isExist}">      {{ filePathConvertFileName(filePath) }}    </span>    <div class="preview-container" :class="{'show': isPreview && props.isExist }" @click="onPreview">      <PreviewIcon class="preview-icon"/>    </div>  </div></template><style scoped>.file-item {  margin: 2px;  padding: 3px;  border: 1px solid var(--theme-border);  border-radius: 5px;  font-size: 12px;  width: 74px;  height: 74px;  display: grid;  place-items: center;  grid-template-rows: 1fr auto;  position: relative;}.file-not-exist-icon {  width: 60px;  height: 60px;}.file-icon {  width: 50px;  height: 50px;}.file-item span {  width: 75px;  display: -webkit-box;  -webkit-box-orient: vertical;  -webkit-line-clamp: 1;  /* 显示一行 */  overflow: hidden;  text-align: center;  align-self: end;  justify-self: center;}.file-not-exist-text {  color: var(--theme-textDelete);  text-decoration: line-through;}.preview-container {  position: absolute;  width: 80px;  height: 80px;  background-color: rgba(0, 0, 0, 0.6);  display: none;  border-radius: 5px;}.preview-container.show {  display: flex;  align-items: center;  justify-content: center;}.preview-icon {  width: 50%;  opacity: 0.6;}.preview-icon:hover {  opacity: 1;}</style>