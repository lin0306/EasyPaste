<script setup lang="ts">import {isAudio, isExcel, isPackage, isPDF, isPPT, isProgram, isTXT, isWord} from "../utils/FileTypeUtil.ts";import PPTIcon from "../assets/icons/PPTIcon.vue";import WordIcon from "../assets/icons/WordIcon.vue";import TXTIcon from "../assets/icons/TXTIcon.vue";import FileIcon from "../assets/icons/FileIcon.vue";import ExcelIcon from "../assets/icons/ExcelIcon.vue";import PDFIcon from "../assets/icons/PDFIcon.vue";import FolderIcon from "../assets/icons/FolderIcon.vue";import {NImage} from "naive-ui";import FileDeleteIcon from "../assets/icons/FileDeleteIcon.vue";import {filePathConvertFileName} from "../utils/strUtil.ts";import PreviewIcon from "../assets/icons/PreviewIcon.vue";import {ref} from "vue";import {createWin} from "../utils/WindowUtil.ts";import {WebviewWindow} from "@tauri-apps/api/webviewWindow";import {emit} from "@tauri-apps/api/event";import {convertFileSrc} from "@tauri-apps/api/core";import VideoIcon from "../assets/icons/VideoIcon.vue";import {isVideo} from "../utils/VideoUtil.ts";import {isImage} from "../utils/ImageUtil.ts";import AudioIcon from "../assets/icons/AudioIcon.vue";import EXEIcon from "../assets/icons/EXEIcon.vue";import PackageIcon from "../assets/icons/PackageIcon.vue";const props = defineProps<{  filePath: string;  isFolder?: boolean;  isExist?: boolean;}>();const isPreview = ref(false);/** * 鼠标移入预览 */function onMouseOver() {  isPreview.value = true;}/** * 鼠标移出取消预览 */function onMouseOut() {  isPreview.value = false;}async function onPreview() {  const existWin = await WebviewWindow.getByLabel("preview");  if (existWin) {    await emit('reload-preview', {filePath: props.filePath});    await existWin.show();    await existWin.setFocus();  } else {    await createWin({      label: 'preview',      url: '/preview?filePath=' + props.filePath,      width: 600,      height: 500,      resizable: true,      visible: true,    });  }}</script><template>  <div class="file-item" @mouseover="onMouseOver" @mouseout="onMouseOut">    <FileDeleteIcon class="file-not-exist-icon" v-if="!isExist"/>    <FolderIcon class="file-icon" v-else-if="isFolder"/>    <n-image        v-else-if="isImage(props.filePath)"        :src="convertFileSrc(props.filePath)"        object-fit="cover"        height="60px"        width="100%"        :lazy="true"        :preview-disabled="true"    />    <VideoIcon class="file-icon" v-else-if="isVideo(props.filePath)"/>    <AudioIcon class="file-icon" v-else-if="isAudio(props.filePath)"/>    <WordIcon class="file-icon" v-else-if="isWord(props.filePath)"/>    <ExcelIcon class="file-icon" v-else-if="isExcel(props.filePath)"/>    <PPTIcon class="file-icon" v-else-if="isPPT(props.filePath)"/>    <PDFIcon class="file-icon" v-else-if="isPDF(props.filePath)"/>    <TXTIcon class="file-icon" v-else-if="isTXT(props.filePath)"/>    <EXEIcon class="file-icon" v-else-if="isProgram(props.filePath)"/>    <PackageIcon class="file-icon" v-else-if="isPackage(props.filePath)"/>    <FileIcon class="file-icon" v-else/>    <span :class="{'file-not-exist-text':!props.isExist}">      {{ filePathConvertFileName(filePath) }}    </span>    <div class="preview-container" :class="{'show': isPreview && props.isExist }">      <PreviewIcon class="preview-icon" @click="onPreview"/>    </div>  </div></template><style scoped>.file-item {  margin: 2px;  padding: 3px;  border: 1px solid var(--theme-border);  border-radius: 5px;  font-size: 12px;  width: 80px;  height: 80px;  display: grid;  place-items: center;  grid-template-rows: 1fr auto;  position: relative;}.file-not-exist-icon {  width: 60px;  height: 60px;}.file-icon {  width: 50px;  height: 50px;}.file-item span {  width: 75px;  display: -webkit-box;  -webkit-box-orient: vertical;  -webkit-line-clamp: 1;  /* 显示一行 */  overflow: hidden;  text-align: center;  align-self: end;  justify-self: center;}.file-not-exist-text {  color: var(--theme-textDelete);  text-decoration: line-through;}.preview-container {  position: absolute;  width: 80px;  height: 80px;  background-color: rgba(0, 0, 0, 0.6);  display: none;  border-radius: 5px;}.preview-container.show {  display: flex;  align-items: center;  justify-content: center;}.preview-icon {  width: 50%;  opacity: 0.6;}.preview-icon:hover {  opacity: 1;}</style>